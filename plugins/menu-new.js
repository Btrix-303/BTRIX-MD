const config = require('../config');
const { cmd, commands } = require('../command');
const { runtime } = require('../lib/functions');
const axios = require('axios');

cmd({
    pattern: "menu",
    desc: "Show interactive menu system",
    category: "menu",
    react: "ðŸ§¾",
    filename: __filename
}, async (conn, mek, m, { from, reply }) => {
    try {
        const menuCaption = `
â•­â”â”â”ã€” *${config.BOT_NAME}* ã€•â”â”â”â”ˆâŠ·
â”‚ ðŸ‘‹ ð‡ðˆ, ðˆðŒ ð€ð‹ðˆð•ð„ ððŽð–
â”‚
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚â˜… |ðŸ“Œ *ð™¾ðš†ð™½ð™´ðš*  : ${config.OWNER_NAME}
â”‚â˜… |ðŸŒ *ð™¼ð™¾ð™³ð™´*   : [${config.MODE}]
â”‚â˜… |âœ¨ *ð™¿ðšð™´ð™µð™¸ðš‡* : [${config.PREFIX}]
â”‚â˜… |ðŸ“Œ *ðš…ð™´ðšðš‚ð™¸ð™¾ð™½* : ${config.version}
â”‚  â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âœ¦
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
ðŸ“‹ *á´„Êœá´á´sá´‡ á´€ á´„á´€á´›á´‡É¢á´Ê€Ê á´›á´ á´‡xá´˜ÊŸá´Ê€á´‡:*

 âž¦âœ§ -ã€˜ *Ê™á´á´› á´á´‡É´á´œ* ã€™ -  âœ§â”â”ˆâŠ·
â”ƒâœ§ âž¦â™¦â‹†â‹†â‹†â‹†â‹†â‹†â‹†â‹†â‹†â‹†â‹†â‹†â‹†â‹†âœ§â”â”ˆâŠ·
â”ƒâœ§â”‚  â¶  *á´…á´á´¡É´ÊŸá´á´…á´‡á´… á´á´‡É´á´œ*
â”ƒâœ§â”‚  â· *É¢Ê€á´á´œá´˜ á´á´‡É´á´œ*
â”ƒâœ§â”‚  â¸ *Ò“á´œÉ´ á´á´‡É´á´œ*
â”ƒâœ§â”‚  â¹  *á´á´¡É´á´‡Ê€ á´á´‡É´á´œ*
â”ƒâœ§â”‚  âº  *á´€Éª á´á´‡É´á´œ*
â”ƒâœ§â”‚  â»  *á´€É´Éªá´á´‡ á´á´‡É´á´œ*
â”ƒâœ§â”‚  â¼  *á´„á´É´á´ á´‡Ê€á´› á´á´‡É´á´œ*
â”ƒâœ§â”‚  â½  *á´á´›Êœá´‡Ê€ á´á´‡É´á´œ*
â”ƒâœ§â”‚  â¾  *Ê€á´‡á´€á´„Ê á´á´‡É´á´œ*
â”ƒâœ§â”‚  â¿  *á´á´€ÉªÉ´ á´á´‡É´á´œ*
â”ƒâœ§ âž¥ â‹†â‹†â‹†â‹†â‹†â‹†â‹†â‹†â‹†â‹†â‹†â‹†â‹†â‹†âœ§â”â”ˆâŠ·
 âž¥â‹†â‹†â‹†â‹†â‹†â‹†â‹†â‹†â‹†â‹†â‹†â‹†â‹†â‹†â‹†â‹†â‹†â‹†â‹†â‹†âœ§â”â”ˆâŠ·
> ${config.DESCRIPTION}`;

        const contextInfo = {
            mentionedJid: [m.sender],
            forwardingScore: 999,
            isForwarded: true,
            forwardedNewsletterMessageInfo: {
                newsletterJid: '@newsletter',
                newsletterName: config.OWNER_NAME,
                serverMessageId: 143
            }
        };

        // Function to send menu image with timeout
        const sendMenuImage = async () => {
            try {
                return await conn.sendMessage(
                    from,
                    {
                        image: { url: config.MENU_IMAGE_URL || 'https://files.catbox.moe/yj7zp0.png' },
                        caption: menuCaption,
                        contextInfo: contextInfo
                    },
                    { quoted: mek }
                );
            } catch (e) {
                console.log('Image send failed, falling back to text');
                return await conn.sendMessage(
                    from,
                    { text: menuCaption, contextInfo: contextInfo },
                    { quoted: mek }
                );
            }
        };
        // Function to send menu audio with timeout
        const sendMenuAudio = async () => {
            try {
                await new Promise(resolve => setTimeout(resolve, 1000)); // Small delay after image
                await conn.sendMessage(from, {
                    audio: { url: 'https://files.catbox.moe/wzodz1.mp3' },
                    mimetype: 'audio/mp4',
                    ptt: true,
                }, { quoted: mek });
            } catch (e) {
                console.log('Audio send failed, continuing without it');
            }
        };
        
        // Send image first, then audio sequentially
        let sentMsg;
        try {
            // Send image with 10s timeout
            sentMsg = await Promise.race([
                sendMenuImage(),
                new Promise((_, reject) => setTimeout(() => reject(new Error('Image send timeout')), 10000))
            ]);
            
            // Then send audio with 1s delay and 8s timeout
            await Promise.race([
                sendMenuAudio(),
                new Promise((_, reject) => setTimeout(() => reject(new Error('Audio send timeout')), 8000))
            ]);
        } catch (e) {
            console.log('Menu send error:', e);
            if (!sentMsg) {
                sentMsg = await conn.sendMessage(
                    from,
                    { text: menuCaption, contextInfo: contextInfo },
                    { quoted: mek }
                );
            }
        }
        
        const messageID = sentMsg.key.id;

        // Menu data (complete version)
        const menuData = {
            '1': {
                title: "ðŸ“¥ *Download Menu* ðŸ“¥",
                content: `â•­â”â”â”ã€” *Download Menu* ã€•â”â”â”â”ˆâŠ·
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸŒ *Social Media*
â”ƒâ˜…â”‚ â€¢ ð”½á´€á´„á´‡Ê™á´á´á´‹ 
â”ƒâ˜…â”‚ â€¢ ð•„á´‡á´…Éªá´€êœ°ÉªÊ€á´‡ 
â”ƒâ˜…â”‚ â€¢ ð•‹Éªá´‹á´›á´á´‹ 
â”ƒâ˜…â”‚ â€¢ ð•‹á´¡Éªá´›á´›á´‡Ê€ 
â”ƒâ˜…â”‚ â€¢ ð•€É´êœ±á´›á´€É¢Ê€á´€á´
â”ƒâ˜…â”‚ â€¢ ð”¸á´˜á´‹
â”ƒâ˜…â”‚ â€¢ ð•€á´É¢
â”ƒâ˜…â”‚ â€¢ ð•‹á´›2
â”ƒâ˜…â”‚ â€¢ â„™ÉªÉ´êœ±
â”ƒâ˜…â”‚ â€¢ ð”¸á´˜á´‹2
â”ƒâ˜…â”‚ â€¢ ð”½Ê™2
â”ƒâ˜…â”‚ â€¢ â„™ÉªÉ´á´›á´‡Ê€á´‡êœ±á´›
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸŽµ *Music/Video*
â”ƒâ˜…â”‚ â€¢ ð•Šá´˜á´á´›Éªêœ°Ê 
â”ƒâ˜…â”‚ â€¢ â„™ÊŸá´€Ê 
â”ƒâ˜…â”‚ â€¢ â„™ÊŸá´€Ê2-10
â”ƒâ˜…â”‚ â€¢ ð”¸á´œá´…Éªá´ 
â”ƒâ˜…â”‚ â€¢ ð•Éªá´…á´‡á´ 
â”ƒâ˜…â”‚ â€¢ ð•Éªá´…á´‡á´á´…á´á´„
â”ƒâ˜…â”‚ â€¢ ð•á´›á´á´˜3 
â”ƒâ˜…â”‚ â€¢ ð•á´›á´á´˜4
â”ƒâ˜…â”‚ â€¢ ð•Šá´É´É¢ 
â”ƒâ˜…â”‚ â€¢ ð”»Ê€á´€á´á´€ 
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            },
            '2': {
                title: "ðŸ‘¥ *Group Menu* ðŸ‘¥",
                content: `â•­â”â”â”ã€” *Group Menu* ã€•â”â”â”â”ˆâŠ·
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸ› ï¸ *Management*
â”ƒâ˜…â”‚ â€¢ ð”¾Ê€á´á´œá´˜ÊŸÉªÉ´á´‹
â”ƒâ˜…â”‚ â€¢ ð•‚Éªá´„á´‹á´€ÊŸÊŸ
â”ƒâ˜…â”‚ â€¢ ð•‚Éªá´„á´‹á´€ÊŸÊŸ2
â”ƒâ˜…â”‚ â€¢ ð•‚Éªá´„á´‹á´€ÊŸÊŸ3
â”ƒâ˜…â”‚ â€¢ ð”¸á´…á´…
â”ƒâ˜…â”‚ â€¢ â„á´‡á´á´á´ á´‡
â”ƒâ˜…â”‚ â€¢ ð•‚Éªá´„á´‹
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ âš¡ *Admin Tools*
â”ƒâ˜…â”‚ â€¢ â„™Ê€á´á´á´á´›á´‡
â”ƒâ˜…â”‚ â€¢ ð”»á´‡á´á´á´›á´‡
â”ƒâ˜…â”‚ â€¢ ð”»Éªêœ±á´Éªêœ±êœ± 
â”ƒâ˜…â”‚ â€¢ â„á´‡á´ á´á´‹á´‡
â”ƒâ˜…â”‚ â€¢ ð•„á´œá´›á´‡
â”ƒâ˜…â”‚ â€¢ ð•ŒÉ´á´á´œá´›á´‡
â”ƒâ˜…â”‚ â€¢ ð•ƒá´á´„á´‹É¢á´„
â”ƒâ˜…â”‚ â€¢ ð•ŒÉ´ÊŸá´á´„á´‹É¢á´„
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸ·ï¸ *Tagging*
â”ƒâ˜…â”‚ â€¢ ð•‹á´€É¢
â”ƒâ˜…â”‚ â€¢ â„Éªá´…á´‡á´›á´€É¢
â”ƒâ˜…â”‚ â€¢ ð•‹á´€É¢á´€ÊŸÊŸ
â”ƒâ˜…â”‚ â€¢ ð•‹á´€É¢á´€á´…á´ÉªÉ´êœ±
â”ƒâ˜…â”‚ â€¢ ð•€É´á´ Éªá´›á´‡
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            },
            '3': {
                title: "ðŸ˜„ *Fun Menu* ðŸ˜„",
                content: `â•­â”â”â”ã€” *Fun Menu* ã€•â”â”â”â”ˆâŠ·
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸŽ­ *Interactive*
â”ƒâ˜…â”‚ â€¢ ð•ŠÊœá´€á´˜á´€Ê€
â”ƒâ˜…â”‚ â€¢ â„á´€á´›á´‡
â”ƒâ˜…â”‚ â€¢ ð•€É´êœ±á´œÊŸá´›
â”ƒâ˜…â”‚ â€¢ â„á´€á´„á´‹
â”ƒâ˜…â”‚ â€¢ ð•ŠÊœÉªá´˜
â”ƒâ˜…â”‚ â€¢ â„‚Êœá´€Ê€á´€á´„á´›á´‡Ê€
â”ƒâ˜…â”‚ â€¢ â„™Éªá´„á´‹á´œá´˜
â”ƒâ˜…â”‚ â€¢ ð•á´á´‹á´‡
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸ˜‚ *Reactions*
â”ƒâ˜…â”‚ â€¢ â„Ê€á´›
â”ƒâ˜…â”‚ â€¢ â„á´˜Ê
â”ƒâ˜…â”‚ â€¢ ð•ŠÊá´…
â”ƒâ˜…â”‚ â€¢ ð”¸É´É¢á´‡Ê€
â”ƒâ˜…â”‚ â€¢ ð•ŠÊœÊ
â”ƒâ˜…â”‚ â€¢ ð•‚Éªêœ±êœ±
â”ƒâ˜…â”‚ â€¢ ð•„á´É´
â”ƒâ˜…â”‚ â€¢ â„‚á´œÉ´êœ°á´œá´¢á´‡á´…
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            },
            '4': {
                title: "ðŸ‘‘ *Owner Menu* ðŸ‘‘",
                content: `â•­â”â”â”ã€” *Owner Menu* ã€•â”â”â”â”ˆâŠ·
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ âš ï¸ *Restricted*
â”ƒâ˜…â”‚ â€¢ ð”¹ÊŸá´á´„á´‹
â”ƒâ˜…â”‚ â€¢ ð•ŒÉ´Ê™ÊŸá´á´„á´‹
â”ƒâ˜…â”‚ â€¢ ð”½á´œÊŸÊŸá´˜á´˜
â”ƒâ˜…â”‚ â€¢ ð•Šá´‡á´›á´˜á´˜
â”ƒâ˜…â”‚ â€¢ â„á´‡êœ±á´›á´€Ê€á´›
â”ƒâ˜…â”‚ â€¢ ð•ŠÊœá´œá´›á´…á´á´¡É´
â”ƒâ˜…â”‚ â€¢ ð•Œá´˜á´…á´€á´›á´‡á´„á´á´…
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ï¿½ï¿½ï¿½â”€â”€
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ â„¹ï¸ *Info Tools*
â”ƒâ˜…â”‚ â€¢ ð”¾á´ŠÉªá´…
â”ƒâ˜…â”‚ â€¢ ð•Éªá´…
â”ƒâ˜…â”‚ â€¢ ð•ƒÉªêœ±á´›á´„á´á´…
â”ƒâ˜…â”‚ â€¢ ð”¸ÊŸÊŸá´á´‡É´á´œ
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            },
            '5': {
                title: "ðŸ¤– *AI Menu* ðŸ¤–",
                content: `â•­â”â”â”ã€” *AI Menu* ã€•â”â”â”â”ˆâŠ·
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸ’¬ *Chat AI*
â”ƒâ˜…â”‚ â€¢ ð”¸Éª
â”ƒâ˜…â”‚ â€¢ ð”¾á´˜á´›3
â”ƒâ˜…â”‚ â€¢ ð”¾á´˜á´›2
â”ƒâ˜…â”‚ â€¢ â„‚Êœá´€á´›É¢á´˜á´›á´ÉªÉ´Éª
â”ƒâ˜…â”‚ â€¢ ð”¾á´˜á´›
â”ƒâ˜…â”‚ â€¢ ð•„á´‡á´›á´€
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸ–¼ï¸ *Image AI*
â”ƒâ˜…â”‚ â€¢ ð•€á´á´€É¢ÉªÉ´á´‡
â”ƒâ˜…â”‚ â€¢ ð•€á´á´€É¢ÉªÉ´á´‡2
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸ” *Specialized*
â”ƒâ˜…â”‚ â€¢ ð”¹ÊŸá´€á´„á´‹Ê™á´x
â”ƒâ˜…â”‚ â€¢ ð•ƒá´œá´á´€
â”ƒâ˜…â”‚ â€¢ ð”»á´Š
â”ƒâ˜…â”‚ â€¢ ð•‚Êœá´€É´
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            },
            '6': {
                title: "ðŸŽŽ *Anime Menu* ðŸŽŽ",
                content: `â•­â”â”â”ã€” *Anime Menu* ã€•â”â”â”â”ˆâŠ·
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸ–¼ï¸ *Images*
â”ƒâ˜…â”‚ â€¢ ð”½á´€á´„á´‹
â”ƒâ˜…â”‚ â€¢ ð”»á´É¢
â”ƒâ˜…â”‚ â€¢ ð”¸á´¡á´á´
â”ƒâ˜…â”‚ â€¢ ð”¾á´€Ê€ÊŸ
â”ƒâ˜…â”‚ â€¢ ð•Žá´€Éªêœ°á´œ
â”ƒâ˜…â”‚ â€¢ â„•á´‡á´‹á´
â”ƒâ˜…â”‚ â€¢ ð•„á´‡É¢É´á´œá´ÉªÉ´
â”ƒâ˜…â”‚ â€¢ ð•„á´€Éªá´…
â”ƒâ˜…â”‚ â€¢ ð•ƒá´ÊŸÉª
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸŽ­ *Characters*
â”ƒâ˜…â”‚ â€¢ ð”¸É´Éªá´á´‡É¢ÉªÊ€ÊŸ
â”ƒâ˜…â”‚ â€¢ ð”¸É´Éªá´á´‡É¢ÉªÊ€ÊŸ1-5
â”ƒâ˜…â”‚ â€¢ ð”¸É´Éªá´á´‡1-5
â”ƒâ˜…â”‚ â€¢ ð”½á´xÉ¢ÉªÊ€ÊŸ
â”ƒâ˜…â”‚ â€¢ â„•á´€Ê€á´œá´›á´
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            },
            '7': {
                title: "ðŸ”„ *Convert Menu* ðŸ”„",
                content: `â•­â”â”â”ã€” *Convert Menu* ã€•â”â”â”â”ˆâŠ·
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸ–¼ï¸ *Media*
â”ƒâ˜…â”‚ â€¢ ð•Šá´›Éªá´„á´‹á´‡Ê€
â”ƒâ˜…â”‚ â€¢ ð•Šá´›Éªá´„á´‹á´‡Ê€2
â”ƒâ˜…â”‚ â€¢ ð”¼á´á´á´ŠÉªá´Éªx
â”ƒâ˜…â”‚ â€¢ ð•‹á´€á´‹á´‡
â”ƒâ˜…â”‚ â€¢ ð•‹á´á´á´˜3
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸ“ *Text*
â”ƒâ˜…â”‚ â€¢ ð”½á´€É´á´„Ê
â”ƒâ˜…â”‚ â€¢ ð•‹á´›êœ±
â”ƒâ˜…â”‚ â€¢ ð•‹Ê€á´›
â”ƒâ˜…â”‚ â€¢ ð”¹á´€êœ±á´‡64
â”ƒâ˜…â”‚ â€¢ ð•ŒÉ´Ê™á´€êœ±á´‡64
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            },
            '8': {
                title: "ðŸ“Œ *Other Menu* ðŸ“Œ",
                content: `â•­â”â”â”ã€” *Other Menu* ã€•â”â”â”â”ˆâŠ·
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸ•’ *Utilities*
â”ƒâ˜…â”‚ â€¢ ð•‹Éªá´á´‡É´á´á´¡
â”ƒâ˜…â”‚ â€¢ ð”»á´€á´›á´‡
â”ƒâ˜…â”‚ â€¢ â„‚á´á´œÉ´á´›
â”ƒâ˜…â”‚ â€¢ â„‚á´€ÊŸá´„á´œÊŸá´€á´›á´‡
â”ƒâ˜…â”‚ â€¢ â„‚á´á´œÉ´á´›x
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸŽ² *Random*
â”ƒâ˜…â”‚ â€¢ ð”½ÊŸÉªá´˜
â”ƒâ˜…â”‚ â€¢ â„‚á´ÉªÉ´êœ°ÊŸÉªá´˜
â”ƒâ˜…â”‚ â€¢ â„á´„á´ÊŸá´Ê€
â”ƒâ˜…â”‚ â€¢ â„á´ÊŸÊŸ
â”ƒâ˜…â”‚ â€¢ ð”½á´€á´„á´›
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸ” *Search*
â”ƒâ˜…â”‚ â€¢ ð”»á´‡êœ°ÉªÉ´á´‡
â”ƒâ˜…â”‚ â€¢ â„•á´‡á´¡êœ±
â”ƒâ˜…â”‚ â€¢ ð•„á´á´ Éªá´‡
â”ƒâ˜…â”‚ â€¢ ð•Žá´‡á´€á´›Êœá´‡Ê€
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            },
            '9': {
                title: "ðŸ’ž *Reactions Menu* ðŸ’ž",
                content: `â•­â”â”â”ã€” *Reactions Menu* ã€•â”â”â”â”ˆâŠ·
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ â¤ï¸ *Affection*
â”ƒâ˜…â”‚ â€¢ â„‚á´œá´…á´…ÊŸá´‡
â”ƒâ˜…â”‚ â€¢ â„á´œÉ¢
â”ƒâ˜…â”‚ â€¢ ð•‚Éªêœ±êœ±
â”ƒâ˜…â”‚ â€¢ ð•ƒÉªá´„á´‹
â”ƒâ˜…â”‚ â€¢ â„™á´€á´›
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸ˜‚ *Funny*
â”ƒâ˜…â”‚ â€¢ ð”¹á´œÊŸÊŸÊ
â”ƒâ˜…â”‚ â€¢ ð”¹á´É´á´‹
â”ƒâ˜…â”‚ â€¢ ð•á´‡á´‡á´›
â”ƒâ˜…â”‚ â€¢ ð•ŠÊŸá´€á´˜
â”ƒâ˜…â”‚ â€¢ ð•‚ÉªÊŸÊŸ
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸ˜Š *Expressions*
â”ƒâ˜…â”‚ â€¢ ð”¹ÊŸá´œêœ±Êœ
â”ƒâ˜…â”‚ â€¢ ð•Šá´ÉªÊŸá´‡
â”ƒâ˜…â”‚ â€¢ â„á´€á´˜á´˜Ê
â”ƒâ˜…â”‚ â€¢ ð•ŽÉªÉ´É¢
â”ƒâ˜…â”‚ â€¢ â„™á´á´‹á´‡
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            },
            '10': {
                title: "ðŸ  *Main Menu* ðŸ ",
                content: `â•­â”â”â”ã€” *Main Menu* ã€•â”â”â”â”ˆâŠ·
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ â„¹ï¸ *Bot Info*
â”ƒâ˜…â”‚ â€¢ â„™ÉªÉ´É¢
â”ƒâ˜…â”‚ â€¢ ð•ƒÉªá´ á´‡
â”ƒâ˜…â”‚ â€¢ ð”¸ÊŸÉªá´ á´‡
â”ƒâ˜…â”‚ â€¢ â„á´œÉ´á´›Éªá´á´‡
â”ƒâ˜…â”‚ â€¢ ð•Œá´˜á´›Éªá´á´‡
â”ƒâ˜…â”‚ â€¢ â„á´‡á´˜á´
â”ƒâ˜…â”‚ â€¢ ð•†á´¡É´á´‡Ê€
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸ› ï¸ *Controls*
â”ƒâ˜…â”‚ â€¢ ð•„á´‡É´á´œ
â”ƒâ˜…â”‚ â€¢ ð•„á´‡É´á´œ2
â”ƒâ˜…â”‚ â€¢ â„á´‡êœ±á´›á´€Ê€á´›
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            }
        };

        // Message handler with improved error handling
        const handler = async (msgData) => {
            try {
                const receivedMsg = msgData.messages[0];
                if (!receivedMsg?.message || !receivedMsg.key?.remoteJid) return;

                const isReplyToMenu = receivedMsg.message.extendedTextMessage?.contextInfo?.stanzaId === messageID;
                
                if (isReplyToMenu) {
                    const receivedText = receivedMsg.message.conversation || 
                                      receivedMsg.message.extendedTextMessage?.text;
                    const senderID = receivedMsg.key.remoteJid;

                    if (menuData[receivedText]) {
                        const selectedMenu = menuData[receivedText];
                        
                        try {
                            if (selectedMenu.image) {
                                await conn.sendMessage(
                                    senderID,
                                    {
                                        image: { url: config.MENU_IMAGE_URL || 'https://files.catbox.moe/yj7zp0.png' },
                                        caption: selectedMenu.content,
                                        contextInfo: contextInfo
                                    },
                                    { quoted: receivedMsg }
                                );
                            } else {
                                await conn.sendMessage(
                                    senderID,
                                    { text: selectedMenu.content, contextInfo: contextInfo },
                                    { quoted: receivedMsg }
                                );
                            }

                            await conn.sendMessage(senderID, {
                                react: { text: 'âœ…', key: receivedMsg.key }
                            });

                        } catch (e) {
                            console.log('Menu reply error:', e);
                            await conn.sendMessage(
                                senderID,
                                { text: selectedMenu.content, contextInfo: contextInfo },
                                { quoted: receivedMsg }
                            );
                        }

                    } else {
                        await conn.sendMessage(
                            senderID,
                            {
                                text: `âŒ *Invalid Option!* âŒ\n\nPlease reply with a number between 1-10 to select a menu.\n\n*Example:* Reply with "1" for Download Menu\n\n> ${config.DESCRIPTION}`,
                                contextInfo: contextInfo
                            },
                            { quoted: receivedMsg }
                        );
                    }
                }
            } catch (e) {
                console.log('Handler error:', e);
            }
        };

        // Add listener
        conn.ev.on("messages.upsert", handler);

        // Remove listener after 5 minutes
        setTimeout(() => {
            conn.ev.off("messages.upsert", handler);
        }, 300000);

    } catch (e) {
        console.error('Menu Error:', e);
        try {
            await conn.sendMessage(
                from,
                { text: `âŒ Menu system is currently busy. Please try again later.\n\n> ${config.DESCRIPTION}` },
                { quoted: mek }
            );
        } catch (finalError) {
            console.log('Final error handling failed:', finalError);
        }
    }
});
                
